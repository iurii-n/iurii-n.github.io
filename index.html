<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Gift</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <style>
        body {
            font-family: Lato;
            text-align: center;
        }
        .tag-cloud {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        .tag {
            margin: 10px;
            padding: 4px 10px;
            font-size: 1.5rem;
            line-height: 1.75;
            background-color: transparent; /* –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1); /* –¢–µ–Ω—å –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
        }
        .tag button {
            margin-left: 5px;
            padding: 2px 5px;
            font-size: 1rem;
            background-color: transparent;
            border: none;
            cursor: pointer;
            border-radius: 6px;
        }
        .tag button:hover {
            background-color: rgba(233, 30, 99, 1);
        }
        .popup {
            position: fixed;
            top: 55%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            border: 1px solid #ccc;
            padding: 20px;
            border-radius: 6px;
            visibility: hidden;
            opacity: 0;
            transition: all 0.5s ease-in-out;
            z-index: -1; /* Hide it in the back of the page */
        }
        .popup.show {
            visibility: visible;
            opacity: 1;
            z-index: 200;
        }
        #get-gift-btn,#close-popup,#add-tag-btn,#new-tag {
            background-color: transparent;
            border: 1px solid #ccc;
            border-radius: 6px;
            padding: 10px 20px;
            font-size: 1.5rem;
            cursor: pointer;
            margin-top: 20px; /* –î–æ–±–∞–≤—å—Ç–µ –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –¥–ª—è –∫–Ω–æ–ø–∫–∏ */
        }
        #get-gift-btn:hover,#close-popup:hover,#add-tag-btn:hover {
            background-color: rgba(233, 30, 99, 1);
        }
        .dice-animation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
        }
        .dice-animation.show {
            display: block;
        }
        .dice-animation img {
            width: 100px; /* –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∂–µ–ª–∞–µ–º—ã–π —Ä–∞–∑–º–µ—Ä */
            height: 100px; /* –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∂–µ–ª–∞–µ–º—ã–π —Ä–∞–∑–º–µ—Ä */
        }
        .shake {
            animation: shake 0.5s;
        }

        #h-image{
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        #gift-image {
            width: 150px;
            height: 150px;

        }
        #gift {
            margin: 10px;
            padding: 4px 10px;
            font-size: 1.5rem;
            line-height: 1.75;
            background-color: transparent; /* –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1); /* –¢–µ–Ω—å –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
        }
        .hide {
            display: none;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }
    </style>
</head>
<body>
    <div class="h" id="h-image">
        <img src="https://media.tenor.com/7EEiHjbv4BQAAAAi/pusheen-gift-wrapping.gif" alt="cat Animation" id="gift-image"/>
    </div>
    <div class="tag-cloud" id="tag-cloud"></div>
    <button id="get-gift-btn">üêæ Get</button>
    <div class="dice-animation" id="dice-animation">
        <img src="https://media.tenor.com/qYYeQ6hkWmYAAAAi/popcorn-pop-corn.gif" alt="Dice Animation" />
    </div>
    <div class="popup" id="popup">
        <h1>Your Gift:</h1>
        <p id="gift"></p>
        <button id="close-popup">Close</button>
    </div>

    <form id="add-tag-form">
        <input type="text" id="new-tag" placeholder="Enter a new gift">
        <button id="add-tag-btn">üéÅ Add</button>
    </form>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ –º–∞—Å—Å–∏–≤–∞
        function getRandomElement(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ —Å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å—é –∫ –±–µ–ª–æ–º—É —Ñ–æ–Ω—É
        function getRandomColor() {
            let r, g, b;
            do {
                r = Math.floor(Math.random() * 256);
                g = Math.floor(Math.random() * 256);
                b = Math.floor(Math.random() * 256);
            } while (isTooLight(r, g, b)); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–≤–µ—Ç–ª–æ—Å—Ç—å
            return `rgb(${r}, ${g}, ${b})`;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ü–≤–µ—Ç —Å–ª–∏—à–∫–æ–º —Å–≤–µ—Ç–ª—ã–º
        function isTooLight(r, g, b) {
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            return brightness > 200; // –ï—Å–ª–∏ —è—Ä–∫–æ—Å—Ç—å –±–æ–ª—å—à–µ 200, —Ü–≤–µ—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º —Å–≤–µ—Ç–ª—ã–º
        }

        // –ú–∞—Å—Å–∏–≤ –ø–æ–¥–∞—Ä–∫–æ–≤
        let giftList = ['Your other one','Yandex station 2', 'Telegram premium', 'Waffle iron', 'Earrings'];

        // –í—ã–≤–æ–¥ —Ç–µ–≥–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
        const tagCloud = document.getElementById('tag-cloud');
        const giftColors = []; // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ü–≤–µ—Ç–æ–≤
        giftList.forEach((gift, index) => {
            const tag = document.createElement('div');
            tag.classList.add('tag');
            const color = getRandomColor();
            tag.style.color = color; // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç–∞
            giftColors.push(color); // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞

            const span = document.createElement('span');
            span.textContent = gift;
            tag.appendChild(span);

            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è
            const editBtn = document.createElement('button');
            editBtn.innerHTML = '<i class="fas fa-edit"></i>'; // –ò–∫–æ–Ω–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            editBtn.onclick = () => {
                const input = document.createElement('input');
                input.type = 'text';
                input.value = span.textContent;
                tag.replaceChild(input, span);
                input.focus();
                input.onblur = () => {
                    span.textContent = input.value;
                    tag.replaceChild(span, input);
                    updateGiftList(span.textContent, gift);
                };
                input.onkeydown = (e) => {
                    if (e.key === 'Enter') {
                        span.textContent = input.value;
                        tag.replaceChild(span, input);
                        updateGiftList(span.textContent, gift);
                    }
                };
            };

            const deleteBtn = document.createElement('button');
            deleteBtn.innerHTML = '<i class="fas fa-trash-alt"></i>'; // –ò–∫–æ–Ω–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
            deleteBtn.onclick = () => {
                removeGiftFromList(tag);
                tagCloud.removeChild(tag);

            };

            tag.appendChild(editBtn);
            tag.appendChild(deleteBtn);

            tagCloud.appendChild(tag);
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è giftList –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç–µ–≥–∞
        function updateGiftList(newText, oldText, ) {
            const index = giftList.indexOf(oldText);
            if (index !== -1) {
                giftList[index] = newText;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ç–µ–≥–∞ –∏–∑ giftList
        function removeGiftFromList(tag) {
            const span = tag.querySelector('span');
            const gift = span.textContent;
            const index = giftList.indexOf(gift);
            if (index !== -1) {
                giftList.splice(index, 1);
                giftColors.splice(index, 1); // –£–¥–∞–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –∏–∑ –º–∞—Å—Å–∏–≤–∞
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–µ–≥–∞ –≤ giftList
        function addGiftToList(newText) {
            giftList.push(newText);
        }

        let clickCount = 0;

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "Get"
        document.getElementById('get-gift-btn').addEventListener('click', () => {
            clickCount++;
            if (clickCount > 1) {
                const getGiftBtn = document.getElementById('get-gift-btn');
                getGiftBtn.classList.add('shake');
                setTimeout(() => {
                    getGiftBtn.classList.remove('shake');
                }, 500); // –£–¥–∞–ª—è–µ–º –∫–ª–∞—Å—Å —á–µ—Ä–µ–∑ 0.5 —Å–µ–∫—É–Ω–¥—ã
            } else {
                // –û—Å—Ç–∞–ª—å–Ω–æ–π –≤–∞—à –∫–æ–¥ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É "Get"
                const diceAnimation = document.getElementById('dice-animation');
                diceAnimation.classList.add('show');
                const randomIndex = Math.floor(Math.random() * giftList.length);
                const randomGift = giftList[randomIndex];
                const popup = document.getElementById('popup');
                const giftElement = document.getElementById('gift');
                giftElement.textContent = randomGift;
                giftElement.style.color = giftColors[randomIndex]; // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞

                // –°–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫–∏ –∏ –ø–æ–ª–µ –≤–≤–æ–¥–∞
                document.querySelectorAll('.tag button').forEach(button => button.classList.add('hide'));
                document.getElementById('add-tag-btn').classList.add('hide');
                document.getElementById('new-tag').classList.add('hide');

                // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ –ø–æ–∫–∞–∑ –ø–æ–ø–∞–ø–∞ —á–µ—Ä–µ–∑ —Å–ª—É—á–∞–π–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç 5 –¥–æ 10 —Å–µ–∫—É–Ω–¥
                setTimeout(() => {
                    diceAnimation.classList.remove('show');
                    popup.classList.add('show');
                }, Math.floor(Math.random() * 5000) + 5000); // 5-10 —Å–µ–∫—É–Ω–¥
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "Close" –≤ –ø–æ–ø–∞–ø–µ
        document.getElementById('close-popup').addEventListener('click', () => {
            const popup = document.getElementById('popup');
            popup.classList.remove('show');
            clickCount = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏–π

            // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫–∏ –∏ –ø–æ–ª–µ –≤–≤–æ–¥–∞
            document.querySelectorAll('.tag button').forEach(button => button.classList.remove('hide'));
            document.getElementById('add-tag-btn').classList.remove('hide');
            document.getElementById('new-tag').classList.remove('hide');
        });
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–∞ –ø–æ –Ω–∞–∂–∞—Ç–∏—é –Ω–∞ Esc
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' || e.key === 'Esc') {
                const popup = document.getElementById('popup');
                if (popup.classList.contains('show')) {
                    popup.classList.remove('show');
                    clickCount = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏–π

                    // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫–∏ –∏ –ø–æ–ª–µ –≤–≤–æ–¥–∞
                    document.querySelectorAll('.tag button').forEach(button => button.classList.remove('hide'));
                    document.getElementById('add-tag-btn').classList.remove('hide');
                    document.getElementById('new-tag').classList.remove('hide');
                }
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–µ–≥–∞
        document.getElementById('add-tag-btn').addEventListener('click', (e) => {
            e.preventDefault();
            const newTagText = document.getElementById('new-tag').value;
            if (newTagText) {
                addGiftToList(newTagText);
                const tag = document.createElement('div');
                tag.classList.add('tag');
                const color = getRandomColor();
                tag.style.color = color; // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç–∞
                giftColors.push(color);
                const span = document.createElement('span');
                span.textContent = newTagText;
                tag.appendChild(span);

                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è
                const editBtn = document.createElement('button');
                editBtn.innerHTML = '<i class="fas fa-edit"></i>'; // –ò–∫–æ–Ω–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                editBtn.onclick = () => {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.value = span.textContent;
                    tag.replaceChild(input, span);
                    input.focus();
                    input.onblur = () => {
                        span.textContent = input.value;
                        tag.replaceChild(span, input);
                        updateGiftList(span.textContent, newTagText);
                    };
                    input.onkeydown = (e) => {
                        if (e.key === 'Enter') {
                            span.textContent = input.value;
                            tag.replaceChild(span, input);
                            updateGiftList(span.textContent, newTagText);
                        }
                    };
                };

                const deleteBtn = document.createElement('button');
                deleteBtn.innerHTML = '<i class="fas fa-trash-alt"></i>'; // –ò–∫–æ–Ω–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
                deleteBtn.onclick = () => {
                    tagCloud.removeChild(tag);
                    removeGiftFromList(tag);
                };

                tag.appendChild(editBtn);
                tag.appendChild(deleteBtn);

                tagCloud.appendChild(tag);
                document.getElementById('new-tag').value = '';
            }
        });
    </script>
</body>
</html>